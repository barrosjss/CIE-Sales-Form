<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Certificación Coach de Ventas - CIE Barcelona</title>

  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Estilos adicionales para componentes */
    input, select, textarea {
      font-family: system-ui, -apple-system, sans-serif;
    }

    input[type="checkbox"] {
      width: 1rem;
      height: 1rem;
      cursor: pointer;
      flex-shrink: 0;
    }

    /* Grid responsive */
    @media (min-width: 768px) {
      .md\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    /* Animación para mensajes */
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden {
      display: none !important;
    }

    /* Custom dropdown para sector */
    .sector-dropdown-container {
      position: relative;
    }

    .sector-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      max-height: 200px;
      overflow-y: auto;
      background: white;
      border: 1px solid #d1d5db;
      border-top: none;
      border-radius: 0 0 0.375rem 0.375rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      z-index: 50;
    }

    .sector-dropdown-option {
      padding: 0.5rem 0.75rem;
      cursor: pointer;
      transition: background-color 0.15s;
    }

    .sector-dropdown-option:hover {
      background-color: #f3f4f6;
    }

    .sector-dropdown-option.selected {
      background-color: #dbeafe;
      color: #1e40af;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="container mx-auto py-8 px-4 max-w-3xl">
    <!-- Logo CIE Barcelona -->
    <div class="flex justify-center mb-6">
      <img src="assets/logo-20con-20texto-20color-281-29.png"
           alt="Coaching Comercial CIE Barcelona"
           class="h-20 w-auto">
    </div>

    <!-- Formulario Principal (Card) -->
    <div id="form-card" class="bg-white rounded-lg shadow-md">
      <!-- Header -->
      <div class="p-6 border-b border-gray-200">
        <h1 class="text-2xl font-bold text-gray-900">Certificación Coach de Ventas</h1>
        <p class="text-sm text-gray-600 italic mt-1">* Campos obligatorios</p>
      </div>

      <!-- Form Content -->
      <form id="cie-form" class="p-6 space-y-8">

        <!-- Sección 1: Edición -->
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-blue-600">Certificarme como Coach de Ventas</h3>

          <div class="space-y-2">
            <label for="edition" class="block text-sm font-medium text-gray-700">Edición: *</label>
            <select id="edition" name="edition" required
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="">Selecciona una edición</option>
              <option value="streaming">Streaming</option>
              <option value="madrid">Madrid - ES</option>
              <option value="medellin">Medellín CO</option>
              <option value="santiago">Santiago CL</option>
              <option value="barcelona">Barcelona | ES</option>
              <option value="panama">Panamá PA</option>
              <option value="quito">Quito EC</option>
              <option value="san_jose">San José Cr</option>
              <option value="buenos_aires">Buenos Aires |</option>
              <option value="bogota">Bogotá - CO</option>
              <option value="guayaquil">Guayaquil |</option>
            </select>
          </div>
        </div>

        <!-- Sección 2: Datos de Contacto -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold border-b border-gray-200 pb-2">Datos de contacto *obligatorio</h3>

          <div class="space-y-2">
            <label for="email" class="block text-sm font-medium text-gray-700">Correo electrónico*</label>
            <input type="email" id="email" name="email" required
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="space-y-2">
              <label for="first_name" class="block text-sm font-medium text-gray-700">Nombres*</label>
              <input type="text" id="first_name" name="first_name" required
                     class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="space-y-2">
              <label for="last_name" class="block text-sm font-medium text-gray-700">Apellidos*</label>
              <input type="text" id="last_name" name="last_name" required
                     class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
          </div>

          <div class="space-y-2">
            <label for="whatsapp" class="block text-sm font-medium text-gray-700">whatsApp con indicativo*</label>
            <input type="tel" id="whatsapp" name="whatsapp" required
                   placeholder="+34 600 000 000"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="city" class="block text-sm font-medium text-gray-700">Ciudad*</label>
            <input type="text" id="city" name="city" required
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="country" class="block text-sm font-medium text-gray-700">País*</label>
            <select id="country" name="country" required
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="">Selecciona un país</option>
              <option value="ES">España</option>
              <option value="MX">México</option>
              <option value="CO">Colombia</option>
              <option value="AR">Argentina</option>
              <option value="CL">Chile</option>
              <option value="PE">Perú</option>
              <option value="OTHER">Otro</option>
            </select>
          </div>
        </div>

        <!-- Sección 3: Perfil Profesional -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold border-b border-gray-200 pb-2">Perfil profesional</h3>

          <div class="space-y-2">
            <label for="linkedin" class="block text-sm font-medium text-gray-700">Linkedin</label>
            <input type="url" id="linkedin" name="linkedin"
                   placeholder="https://linkedin.com/in/tu-perfil"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="company_name" class="block text-sm font-medium text-gray-700">Empresa o actividad actual*</label>
            <input type="text" id="company_name" name="company_name" required
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="sector" class="block text-sm font-medium text-gray-700">Sector o actividad</label>
            <div class="sector-dropdown-container">
              <input type="text" id="sector" name="sector"
                     placeholder="Escribe o selecciona un sector..."
                     autocomplete="off"
                     class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div id="sector-dropdown" class="sector-dropdown hidden"></div>
            </div>
          </div>

          <div class="space-y-2">
            <label for="sales_position" class="block text-sm font-medium text-gray-700">Personal de ventas su cargo</label>
            <input type="text" id="sales_position" name="sales_position"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="years_experience" class="block text-sm font-medium text-gray-700">Años de experiencia en ventas</label>
            <input type="text" id="years_experience" name="years_experience"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="coaching_experience" class="block text-sm font-medium text-gray-700">Experiencia en coaching</label>
            <input type="text" id="coaching_experience" name="coaching_experience"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>

          <div class="space-y-2">
            <label for="motivations" class="block text-sm font-medium text-gray-700">Algunas motivaciones para certificarme</label>
            <textarea id="motivations" name="motivations" rows="3"
                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
          </div>

          <div class="space-y-2">
            <label for="program_source" class="block text-sm font-medium text-gray-700">He conocido del programa a través de:</label>
            <select id="program_source" name="program_source"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="">Selecciona una opción</option>
              <option value="internet">1 Internet</option>
              <option value="redes_sociales">2 Redes Sociales</option>
              <option value="recomendacion">3 Recomendación</option>
              <option value="miembro_cie">4 Soy empresario miembro CIE Barcelona</option>
              <option value="miembro_jci">5 Soy Miembro JCI</option>
            </select>
          </div>
        </div>

        <!-- Sección 4: Legal (Checkboxes) -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold border-b border-gray-200 pb-2">He leído:</h3>

          <div class="flex items-start space-x-2">
            <input type="checkbox" id="legal_scholarship" name="legal_scholarship" required
                   class="mt-1">
            <label for="legal_scholarship" class="text-sm leading-relaxed text-gray-700 cursor-pointer">
              Esta petición no implica confirmación de plaza. CIE Barcelona hará una valoración técnica de la petición enviada y si aplica la persona aplicante a una beca la comunicará a la mayor brevedad posible (máximo 48h desde la recepción de esta petición). Si el dictamen es que NO procede beca, para poder avanzar el proceso, la persona solicitante recibe información de las diferentes formas de financiamiento de su proceso de certificación. Sí el dictamen es SI PROCEDE, se envía a la persona aplicante el procedimiento a seguir para hacer efectiva su plaza becada. Agradecemos de antemano su interés.
            </label>
          </div>

          <div class="flex items-start space-x-2">
            <input type="checkbox" id="legal_privacy" name="legal_privacy" required
                   class="mt-1">
            <label for="legal_privacy" class="text-sm leading-relaxed text-gray-700 cursor-pointer">
              * CIE Barcelona gestiona sus datos únicamente con fines académicos y de promoción económica. Su información no será traspasada a terceros.
            </label>
          </div>
        </div>

        <!-- Botón Submit -->
        <div class="flex justify-center pt-6 border-t border-gray-200">
          <button type="submit"
                  class="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium px-12 py-2 rounded-md transition-colors">
            ENVIAR
          </button>
        </div>
      </form>
    </div>

    <!-- Pantalla de Éxito (oculta por defecto) -->
    <div id="success-screen" class="hidden bg-white rounded-lg shadow-md p-12 text-center fade-in">
      <!-- Icono de Check Circle (SVG) -->
      <svg class="w-20 h-20 text-green-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <h2 class="text-3xl text-green-600 font-bold mb-2">¡Solicitud enviada con éxito!</h2>
      <p class="text-gray-600">Recibirás respuesta en 24-48h hábiles. Hemos enviado una copia a tu email.</p>
    </div>

    <!-- Pantalla de Error (oculta por defecto) -->
    <div id="error-screen" class="hidden bg-white rounded-lg shadow-md p-12 text-center fade-in">
      <h2 class="text-2xl text-red-600 font-bold mb-4">Hubo un problema. Por favor intenta nuevamente</h2>
      <button onclick="resetForm()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-8 py-2 rounded-md transition-colors">
        Reintentar
      </button>
    </div>
  </div>

  <script>
    // Validación de campos
    function validateForm() {
      const form = document.getElementById('cie-form');

      // Campos requeridos
      const required = ['edition', 'email', 'first_name', 'last_name', 'whatsapp', 'city', 'country', 'company_name'];

      for (const field of required) {
        const element = form.querySelector(`[name="${field}"]`);
        const value = element ? element.value.trim() : '';

        if (!value) {
          alert(`El campo "${field}" es obligatorio`);
          element.focus();
          return false;
        }
      }

      // Validar email
      const email = form.querySelector('[name="email"]').value;
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert('Por favor ingresa un email válido');
        form.querySelector('[name="email"]').focus();
        return false;
      }

      // Checkboxes legales DEBEN estar marcados
      if (!document.getElementById('legal_scholarship').checked) {
        alert('Debes aceptar los términos de becas para continuar');
        return false;
      }

      if (!document.getElementById('legal_privacy').checked) {
        alert('Debes aceptar la política de privacidad para continuar');
        return false;
      }

      return true;
    }

    // Manejo del submit
    document.getElementById('cie-form').addEventListener('submit', function(e) {
      e.preventDefault();

      if (!validateForm()) {
        return;
      }

      // Obtener datos del formulario
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());
      data.timestamp = new Date().toISOString();
      data.form_type = 'certificacion';

      // Convertir checkboxes a booleanos
      data.legal_scholarship = document.getElementById('legal_scholarship').checked;
      data.legal_privacy = document.getElementById('legal_privacy').checked;

      // Log para debug (opcional, remover en producción)
      console.log('Form Data:', JSON.stringify(data, null, 2));

      // IMPORTANTE: El script de Clientify capturará el evento submit
      // y procesará los datos automáticamente. No necesitas hacer fetch manual.

      // Mostrar pantalla de éxito (simulado)
      // En producción real, esto debería esperar confirmación de Clientify
      document.getElementById('form-card').classList.add('hidden');
      document.getElementById('success-screen').classList.remove('hidden');
    });

    // Función para reintentar en caso de error
    function resetForm() {
      document.getElementById('error-screen').classList.add('hidden');
      document.getElementById('form-card').classList.remove('hidden');
    }

    // Custom Dropdown para Sector
    (function() {
      const sectorInput = document.getElementById('sector');
      const sectorDropdown = document.getElementById('sector-dropdown');

      const sectors = [
        'Industrial',
        'Servicios',
        'Inmobiliaria',
        'Seguros',
        'Tecnología',
        'Finanzas',
        'Salud',
        'Educación',
        'Comercio',
        'Transporte',
        'Construcción',
        'Turismo',
        'Energía',
        'Telecomunicaciones',
        'Automotriz',
        'Alimentación',
        'Legal',
        'Marketing',
        'Consultoría',
        'Otro'
      ];

      // Mostrar opciones
      function showDropdown(filter = '') {
        const filtered = sectors.filter(sector =>
          sector.toLowerCase().includes(filter.toLowerCase())
        );

        if (filtered.length === 0) {
          sectorDropdown.classList.add('hidden');
          return;
        }

        sectorDropdown.innerHTML = '';
        filtered.forEach(sector => {
          const option = document.createElement('div');
          option.className = 'sector-dropdown-option';
          option.textContent = sector;
          option.addEventListener('click', function() {
            sectorInput.value = sector;
            sectorDropdown.classList.add('hidden');
          });
          sectorDropdown.appendChild(option);
        });

        sectorDropdown.classList.remove('hidden');
      }

      // Eventos del input
      sectorInput.addEventListener('focus', function() {
        showDropdown(this.value);
      });

      sectorInput.addEventListener('input', function() {
        showDropdown(this.value);
      });

      // Cerrar al hacer clic fuera
      document.addEventListener('click', function(e) {
        if (!sectorInput.contains(e.target) && !sectorDropdown.contains(e.target)) {
          sectorDropdown.classList.add('hidden');
        }
      });

      // Navegación con teclado (opcional)
      sectorInput.addEventListener('keydown', function(e) {
        const options = sectorDropdown.querySelectorAll('.sector-dropdown-option');
        const selected = sectorDropdown.querySelector('.sector-dropdown-option.selected');
        let index = Array.from(options).indexOf(selected);

        if (e.key === 'ArrowDown') {
          e.preventDefault();
          if (index < options.length - 1) {
            if (selected) selected.classList.remove('selected');
            options[index + 1].classList.add('selected');
            options[index + 1].scrollIntoView({ block: 'nearest' });
          }
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          if (index > 0) {
            if (selected) selected.classList.remove('selected');
            options[index - 1].classList.add('selected');
            options[index - 1].scrollIntoView({ block: 'nearest' });
          }
        } else if (e.key === 'Enter' && selected) {
          e.preventDefault();
          sectorInput.value = selected.textContent;
          sectorDropdown.classList.add('hidden');
        } else if (e.key === 'Escape') {
          sectorDropdown.classList.add('hidden');
        }
      });
    })();

    // <!-- ESPACIO PARA INSERTAR SCRIPT DE CLIENTIFY ARAÑA -->
    // El script de la araña de Clientify se insertará aquí cuando configures la integración
    // Ejemplo:
    // (function() {
    //   var clientifyScript = document.createElement('script');
    //   clientifyScript.src = 'https://app.clientify.com/web-forms/TU-ID-AQUI.js';
    //   document.body.appendChild(clientifyScript);
    // })();
  </script>
</body>
</html>
